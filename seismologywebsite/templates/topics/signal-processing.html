{% extends 'base-interactive-tools.html' %}


{% block tool_template_image %}
    <img 
        src="{{ url_for('static', filename='img/templates-icons/' + topic_object.image_name) }}"  
        alt="{{ topic_object.title }} - template image"
        class="img-fluid"
    >
{% endblock %}


{% block tool_title %}
    {{ topic_object.title }}
{% endblock %}


{% block tool_title_description %}
    Manipulate seismic data files
{% endblock %}


{% block tool_intro_description %}
    {{ topic_object.description }}
{% endblock %}



{% block tool_user_guide %}
    <p>
        Start by uploading seismic data file using the <kbd>upload</kbd> option. Choose between the available processing tools to edit your uploaded waveform. These tools are presented below:
        <ul>
            <li><a href="https://docs.obspy.org/packages/autogen/obspy.core.trace.Trace.detrend.html">Detrend</a>: Remove the trend variations in a signal using a specific detrend type. Detrending is essential when you want to focus on the fluctuations or patterns in a signal that are not related to the underlying trend. By removing the trend, you can make it easier to analyze the residuals or the noise in the signal, which can provide valuable insights into the underlying processes or phenomena being observed.</li>
            <li><a href="https://docs.obspy.org/packages/autogen/obspy.core.trace.Trace.taper.html">Taper</a>: Apply a weight function window to a signal to reduce the sharp transitions at the edges of the finite signal segment. The tapering window gradually reduces the amplitude of the signal toward its edges, making it smoother and more compatible with Fourier analysis techniques. This results in more accurate frequency domain representations.</li>
            <li><a href="https://docs.obspy.org/packages/autogen/obspy.core.stream.Stream.trim.html">Trim</a>: Remove portions of a signal that are considered unwanted or irrelevant for the specific analysis or application. Trimming can be used to focus on a specific segment of a signal, eliminate noise or artifacts, or isolate particular events or features of interest.</li>
        </ul>
        Every tool contain several options to adjust its functionality. When you are done, download the processed seismic data file using the <kbd>Save</kbd> option at the top menu, in a MiniSEED format.
    </p>
{% endblock %}


{% block tool_body %}
    <div class="container-lg">
        <div class="px-4 py-2 border-bottom border-dark mb-4 mt-5">
            <button class="btn btn-light" id="upload-file-button">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-upload" viewBox="0 0 16 16">
                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>
                    <path d="M7.646 1.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 2.707V11.5a.5.5 0 0 1-1 0V2.707L5.354 4.854a.5.5 0 1 1-.708-.708l3-3z"/>
                </svg>
                Upload
            </button>
            <a class="btn btn-light" id="save-file-button" href="{{ url_for('BP_signal_processing.download_mseed_file') }}">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-download" viewBox="0 0 16 16">
                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>
                    <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>
                </svg>
                Save
            </a>
            <input type="file" id="upload-file-input" name="upload-file-input" style="display: none;">
        </div>
    </div> 
    <div class="container-lg">
        <div id="signal-processing-option-menu">
            <div class="bg-info py-2 px-3">
                <div class="row justify-content-center align-items-center text-center" id="option-row">
                    <div class="col-4 relative-pos">
                        <div class="d-lg-none d-block">
                            <button class="btn btn-info dropdown-toggle" id="detrend-expanding-button-main" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-align-start" viewBox="0 0 16 16">
                                    <path fill-rule="evenodd" d="M1.5 1a.5.5 0 0 1 .5.5v13a.5.5 0 0 1-1 0v-13a.5.5 0 0 1 .5-.5z"/>
                                    <path d="M3 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V7z"/>
                                </svg>
                                <span class="text-dark d-block">Detrend</span>
                            </button>
                            <ul class="dropdown-menu   text-bg-light">
                                <div class="p-3 text-center">
                                    <div class="row justify-content-center text-center">
                                        <div class="col-12">
                                            <p class="text-center  mb-3  fw-bold">Detrend</p>
                                            <hr>
                                            <label for="detrend-type-select-expanding" class="form-label">type</label>
                                            <select class="form-select" name="detrend-type-select" aria-label="Default select example" id="detrend-type-select-expanding">
                                                <option value="simple" name="simple">simple</option>
                                                <option value="linear" name="linear">linear</option>
                                                <option value="constant" name="constant">constant</option>
                                                <option value="polynomial" name="polynomial">polynomial</option>
                                                <option value="spline" name="spline">spline</option>
                                            </select>
                                            <label for="detrend-order-input-expanding" class="form-label">order</label>
                                            <input id="detrend-order-input-expanding" name="detrend-order-input-expanding" class="form-control form-control-sm"  type="number" min="1" max="5"  step="1" value="1">
                                            <button class="btn btn-primary mt-3" id="detrend-apply-button-expanding">apply</button>
                                        </div>
                                    </div>
                                
                                </div>
                            </ul>
                        </div>
                        <div class="d-none d-lg-block">
                            <div class="row align-items-center">
                                <div class="col">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-align-start" viewBox="0 0 16 16">
                                        <path fill-rule="evenodd" d="M1.5 1a.5.5 0 0 1 .5.5v13a.5.5 0 0 1-1 0v-13a.5.5 0 0 1 .5-.5z"/>
                                        <path d="M3 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V7z"/>
                                    </svg>
                                </div>
                                <div class="col">
                                    <p class="text-center  my-0 py-0 fw-bold">Detrend</p>
                                </div>
                            </div>
                            <hr class="mt-1 mb-1">
                            <div class=" d-none d-lg-block">
                                <div class="row justify-content-center align-items-center text-center">
                                    <div class="col-4">
                                        <label for="detrend-type-select" class="form-label">type</label>
                                        <select class="form-select form-element" name="detrend-type-select" aria-label="Default select example" id="detrend-type-select">
                                            <option value="simple" name="simple">simple</option>
                                            <option value="linear" name="linear">linear</option>
                                            <option value="constant" name="constant">constant</option>
                                            <option value="polynomial" name="polynomial">polynomial</option>
                                            <option value="spline" name="spline">spline</option>
                                        </select>
                                    </div>
                                    <div class="col-4">
                                        <label for="detrend-order-input" class="form-label">order</label>
                                        <input id="detrend-order-input" name="detrend-order-input" class="form-control form-control-sm form-element"  type="number" min="1" max="5"  step="1" value="1">
                                    </div>
                                    <div class="col-4">
    
                                    </div>
                                </div>
                            </div>
                            <button class="btn btn-dark mt-3 absolute-pos" id="detrend-apply-button">apply</button>
                        </div>
                    </div>
                    <div class="col-4  border-start border-light border-1 relative-pos">
                        <div class="d-lg-none d-block">
                            <button class="btn btn-info dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-soundwave" viewBox="0 0 16 16">
                                    <path fill-rule="evenodd" d="M8.5 2a.5.5 0 0 1 .5.5v11a.5.5 0 0 1-1 0v-11a.5.5 0 0 1 .5-.5zm-2 2a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5zm4 0a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5zm-6 1.5A.5.5 0 0 1 5 6v4a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm8 0a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm-10 1A.5.5 0 0 1 3 7v2a.5.5 0 0 1-1 0V7a.5.5 0 0 1 .5-.5zm12 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0V7a.5.5 0 0 1 .5-.5z"/>
                                </svg>
                                <span class=" text-dark d-block">Taper</span>
                            </button>
                            <ul class="dropdown-menu   text-bg-light">
                                <div class="p-3 text-center">
                                    <div class="row justify-content-center text-center">
                                        <div class="col-12">
                                            <p class="text-center  mb-3  fw-bold">Taper</p>
                                            <hr>
                                            <label for="taper-type-select-expanding" class="form-label">type</label>
                                            <select class="form-select" aria-label="Default select example" name="taper-type-select" id="taper-type-select-expanding">
                                                <option value="cosine"           name="cosine"          >cosine</option>
                                                <option value="barthann"         name="barthann"        >barthann</option>
                                                <option value="bartlett"         name="bartlett"        >bartlett</option>
                                                <option value="blackman"         name="blackman"        >blackman</option>
                                                <option value="blackmanharris"   name="blackmanharris"  >blackmanharris</option>
                                                <option value="bohman"           name="bohman"          >bohman</option>
                                                <option value="boxcar"           name="boxcar"          >boxcar</option>
                                                <option value="chebwin"          name="chebwin"         >chebwin</option>
                                                <option value="flattop"          name="flattop"         >flattop</option>
                                                <option value="gaussian"         name="gaussian"        >gaussian</option>
                                                <option value="general_gaussian" name="general_gaussian">general_gaussian</option>
                                                <option value="hamming"          name="hamming"         >hamming</option>
                                                <option value="hann"             name="hann"            >hann</option>
                                                <option value="kaiser"           name="kaiser"          >kaiser</option>
                                                <option value="hann"             name="hann"            >hann</option>
                                                <option value="nuttall"          name="nuttall"         >nuttall</option>
                                                <option value="parzen"           name="parzen"          >parzen</option>
                                                <option value="slepian"          name="slepian"         >slepian</option>
                                                <option value="triang"           name="triang"          >triang</option>
                                            </select>
                                            <label for="taper-side-select-expanding" class="form-label">side</label>
                                            <select class="form-select" aria-label="Default select example" name="taper-side-select" id="taper-side-select-expanding">
                                                <option value="left"             name="left"           >left</option>
                                                <option value="right"            name="right"          >right</option>
                                                <option value="both"             name="both"           >both</option>
                                            </select>
                                            <label for="taper-length-input-expanding" class="form-label">length (%)</label>
                                            <input id="taper-length-input-expanding" name="taper-length-input" class="form-control form-control-sm"  type="number" min="0" max="50" step="1" value="30"> 
                                            <button class="btn btn-primary  mt-3 " id="taper-apply-button-expanding">apply</button>
                                        </div>
                                    </div>
                                </div>
                            </ul>
                        </div>
                        <div class="d-none d-lg-block">
                            <div class="row align-items-center">
                                <div class="col">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-soundwave" viewBox="0 0 16 16">
                                        <path fill-rule="evenodd" d="M8.5 2a.5.5 0 0 1 .5.5v11a.5.5 0 0 1-1 0v-11a.5.5 0 0 1 .5-.5zm-2 2a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5zm4 0a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5zm-6 1.5A.5.5 0 0 1 5 6v4a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm8 0a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm-10 1A.5.5 0 0 1 3 7v2a.5.5 0 0 1-1 0V7a.5.5 0 0 1 .5-.5zm12 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0V7a.5.5 0 0 1 .5-.5z"/>
                                    </svg>
                                </div>
                                <div class="col">
                                    <p class="text-center  my-0 py-0 fw-bold">Taper</p>
                                </div>
                            </div>
                            <hr class="mt-1 mb-1">
                            <div class="row justify-content-center align-items-start text-center">
                                <div class="col-4">
                                    <label for="taper-type-select" class="form-label">type</label>
                                    <select class="form-select form-element" name="taper-type-select" aria-label="Default select example" id="taper-type-select">
                                        <option value="cosine"           name="cosine"          >cosine</option>
                                        <option value="barthann"         name="barthann"        >barthann</option>
                                        <option value="bartlett"         name="bartlett"        >bartlett</option>
                                        <option value="blackman"         name="blackman"        >blackman</option>
                                        <option value="blackmanharris"   name="blackmanharris"  >blackmanharris</option>
                                        <option value="bohman"           name="bohman"          >bohman</option>
                                        <option value="boxcar"           name="boxcar"          >boxcar</option>
                                        <option value="chebwin"          name="chebwin"         >chebwin</option>
                                        <option value="flattop"          name="flattop"         >flattop</option>
                                        <option value="gaussian"         name="gaussian"        >gaussian</option>
                                        <option value="general_gaussian" name="general_gaussian">general_gaussian</option>
                                        <option value="hamming"          name="hamming"         >hamming</option>
                                        <option value="hann"             name="hann"            >hann</option>
                                        <option value="kaiser"           name="kaiser"          >kaiser</option>
                                        <option value="hann"             name="hann"            >hann</option>
                                        <option value="nuttall"          name="nuttall"         >nuttall</option>
                                        <option value="parzen"           name="parzen"          >parzen</option>
                                        <option value="slepian"          name="slepian"         >slepian</option>
                                        <option value="triang"           name="triang"          >triang</option>
                                    </select>
                                </div>
                                <div class="col-4">
                                    <label for="taper-side-select" class="form-label">side</label>
                                    <select class="form-select form-element" aria-label="Default select example" name="taper-side-select" id="taper-side-select">
                                        <option value="left"             name="left"           >left</option>
                                        <option value="right"            name="right"          >right</option>
                                        <option value="both"             name="both"           >both</option>
                                    </select>
                                </div>
                                <div class="col-4">
                                    <label for="taper-length-input" class="form-label">length (%)</label>
                                    <input id="taper-length-input" name="taper-length-input" class="form-control form-control-sm form-element"  type="number" min="0" max="50" step="1" value="30"> 
                                </div>
                            </div>
                            <button class="btn btn-dark mt-3 absolute-pos" id="taper-apply-button">apply</button>
                        </div>
                    </div>
                    <div class="col-4  border-start border-light border-1 relative-pos">
                        <div class="d-lg-none d-block">
                            <button class="btn btn-info dropdown-toggle" id="trim-expanding-button-main" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-scissors" viewBox="0 0 16 16">
                                    <path d="M3.5 3.5c-.614-.884-.074-1.962.858-2.5L8 7.226 11.642 1c.932.538 1.472 1.616.858 2.5L8.81 8.61l1.556 2.661a2.5 2.5 0 1 1-.794.637L8 9.73l-1.572 2.177a2.5 2.5 0 1 1-.794-.637L7.19 8.61 3.5 3.5zm2.5 10a1.5 1.5 0 1 0-3 0 1.5 1.5 0 0 0 3 0zm7 0a1.5 1.5 0 1 0-3 0 1.5 1.5 0 0 0 3 0z"/>
                                </svg>
                                <span class="text-dark d-block">Trim</span>
                            </button>
                            <ul class="dropdown-menu  text-bg-light">
                                <div class="p-3 text-center">
                                    <div class="row justify-content-center text-center">
                                        <div class="col-12">
                                            <p class="text-center  mb-3  fw-bold">Trim</p>
                                            <hr>
                                            <label for="trim-left-side-input-expanding" class="form-label">left side (sec)</label>
                                            <input id="trim-left-side-input-expanding" name="trim-left-side-input" class="form-control form-control-sm"  type="number" min="0"  step="1" value="5">
                                            <label for="trim-right-side-input-expanding" class="form-label">right side (sec)</label>
                                            <input id="trim-right-side-input-expanding" name="trim-right-side-input" class="form-control form-control-sm"  type="number" min="0"  step="1" value="10">
                                            <button class="btn btn-primary mt-3" id="trim-apply-button-expanding">apply</button>
                                        </div>
                                    </div>
                                </div>
                            </ul>
                        </div>

                        <div class="d-none d-lg-block">
                            <div class="row align-items-center">
                                <div class="col">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-scissors" viewBox="0 0 16 16">
                                        <path d="M3.5 3.5c-.614-.884-.074-1.962.858-2.5L8 7.226 11.642 1c.932.538 1.472 1.616.858 2.5L8.81 8.61l1.556 2.661a2.5 2.5 0 1 1-.794.637L8 9.73l-1.572 2.177a2.5 2.5 0 1 1-.794-.637L7.19 8.61 3.5 3.5zm2.5 10a1.5 1.5 0 1 0-3 0 1.5 1.5 0 0 0 3 0zm7 0a1.5 1.5 0 1 0-3 0 1.5 1.5 0 0 0 3 0z"/>
                                    </svg>
                                </div>
                                <div class="col">
                                    <p class="text-center  my-0 py-0 fw-bold">Trim</p>
                                </div>
                            </div>
                            <hr class="mt-1 mb-1">
                            <div class="row justify-content-center align-items-start text-center">
                                <div class="col-4">
                                    <label for="trim-left-side-input" class="form-label">left side (sec)</label>
                                    <input id="trim-left-side-input" name="trim-left-side-input" class="form-control form-control-sm form-element"  type="number" min="0"  step="1" value="5">
                                </div>
                                <div class="col-4">
                                    <label for="trim-right-side-input" class="form-label">right side (sec)</label>
                                    <input id="trim-right-side-input" name="trim-right-side-input" class="form-control form-control-sm form-element"  type="number" min="0"  step="1" value="10">
                                </div>
                                <div class="col-4">
                                   
                                </div>
                            </div>
                            <button class="btn btn-dark mt-3 absolute-pos" id="trim-apply-button">apply</button>
                        </div>
                        
                    </div>
                </div>
            </div>
        </div>
    </div>


    <div class="mb-5 container-lg">

        <div class="bg-dark">
            <div class="row gx-2 justify-content-center" id="processing-pills-container">

            </div> 

            <div id="spinner-div">
                <div class="text-center">
                    <div class="spinner-border my-3  bg-warning" role="status" >
                    <span class="visually-hidden">Loading...</span>
                    </div>
                </div>
            </div>

            <div class="row justify-content-center align-items-center"  id="signal-processing-start-by-upload-container">
                <div class="col text-center text-light">
                    <p class="fs-3">Start by <button class="btn btn-outline-info" id="upload-another-file-button">uploading</button> a seismic file</p>
                    <input type="file" id="upload-another-file-input" name="upload-file-input" style="display: none;">
                </div>
            </div>

            <div id="time-series-graph">
                
            </div>
        </div>
    </div>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="/static/js/signal-processing.js"></script>
{% endblock %}
    


*********************************************

    

